<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>VOID / RPS</title>
    <style>
        :root {
            --bg: #0a0a0a;
            --surface: #1a1a1a;
            --p1: #00f2ff;
            --p2: #ff0055;
            --text: #ffffff;
            --border: #333;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Courier New', monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        #ui { text-align: center; margin-bottom: 20px; }
        
        #board {
            display: grid;
            grid-template-columns: repeat(9, 45px);
            grid-template-rows: repeat(9, 45px);
            gap: 1px;
            background-color: var(--border);
            border: 1px solid var(--border);
        }

        .cell {
            width: 45px;
            height: 45px;
            background-color: var(--bg);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: crosshair;
        }

        .piece {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            transition: 0.1s;
        }

        .p1 { color: var(--p1); }
        .p2 { color: var(--p2); }

        .selected {
            background-color: var(--surface);
            box-shadow: inset 0 0 10px var(--p1);
        }

        #log {
            margin-top: 20px;
            width: 414px;
            height: 60px;
            font-size: 10px;
            color: #666;
            overflow: hidden;
            border-left: 1px solid var(--border);
            padding-left: 10px;
        }

        .win-p1 { color: var(--p1); }
        .win-p2 { color: var(--p2); }
    </style>
</head>
<body>

    <div id="ui">
        <div id="status">System Ready</div>
        <div id="turn">Player: Alpha</div>
    </div>

    <div id="board"></div>

    <div id="log"></div>

    <script>
        const board = document.getElementById('board');
        const status = document.getElementById('status');
        const turnDisplay = document.getElementById('turn');
        const log = document.getElementById('log');

        let selected = null;
        let turn = 'p1'; 
        let active = true;

        const winMap = { 'R': 'S', 'S': 'P', 'P': 'R' };
        
        // Initial State (2 of each)
        let pieces = {
            "0-2": {o:'p1', t:'R'}, "0-3": {o:'p1', t:'R'},
            "0-4": {o:'p1', t:'P'}, "0-5": {o:'p1', t:'P'},
            "0-6": {o:'p1', t:'S'}, "1-4": {o:'p1', t:'S'}, // Slightly staggered start

            "8-2": {o:'p2', t:'R'}, "8-3": {o:'p2', t:'R'},
            "8-4": {o:'p2', t:'P'}, "8-5": {o:'p2', t:'P'},
            "8-6": {o:'p2', t:'S'}, "7-4": {o:'p2', t:'S'}
        };

        function writeLog(msg) {
            const entry = document.createElement('div');
            entry.textContent = `> ${msg}`;
            log.prepend(entry);
        }

        function init() {
            board.innerHTML = '';
            for (let r = 0; r < 9; r++) {
                for (let c = 0; c < 9; c++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    const key = `${r}-${c}`;
                    
                    if (pieces[key]) {
                        const p = pieces[key];
                        const pDiv = document.createElement('div');
                        pDiv.className = `piece ${p.o}`;
                        pDiv.textContent = p.t;
                        if (selected && selected.r === r && selected.c === c) pDiv.classList.add('selected');
                        cell.appendChild(pDiv);
                    }
                    cell.onclick = () => { if(turn === 'p1' && active) handleTap(r, c); };
                    board.appendChild(cell);
                }
            }
        }

        function handleTap(r, c) {
            const key = `${r}-${c}`;
            const p = pieces[key];

            if (p && p.o === 'p1') {
                selected = { r, c, p };
                init();
            } else if (selected) {
                if (Math.abs(r - selected.r) <= 1 && Math.abs(c - selected.c) <= 1) {
                    processMove(selected.r, selected.c, r, c);
                }
            }
        }

        function processMove(fr, fc, tr, tc) {
            const att = pieces[`${fr}-${fc}`];
            const def = pieces[`${tr}-${tc}`];
            const targetKey = `${tr}-${tc}`;

            if (def) {
                if (def.o === att.o) return;
                if (att.t === def.t) {
                    writeLog("clash. kinetic halt.");
                    selected = null; init(); return;
                } 
                if (winMap[att.t] === def.t) {
                    writeLog(`${att.t} deletes ${def.t}`);
                    pieces[targetKey] = att;
                } else {
                    writeLog(`${att.t} fails. removed.`);
                }
            } else {
                pieces[targetKey] = att;
            }

            delete pieces[`${fr}-${fc}`];
            selected = null;
            
            if (att.o === 'p1' && tr === 8) return finish("alpha breach. victory.");
            if (att.o === 'p2' && tr === 0) return finish("omega breach. loss.");

            turn = (turn === 'p1') ? 'p2' : 'p1';
            updateUI();
            init();

            if (turn === 'p2') setTimeout(aiBrain, 400);
        }

        function aiBrain() {
            const ai = [];
            for (let k in pieces) if (pieces[k].o === 'p2') {
                const [r, c] = k.split('-').map(Number);
                ai.push({ r, c, t: pieces[k].t });
            }

            if (ai.length === 0) return finish("alpha cleanup. victory.");

            // AI Logic: 1. Kill if possible. 2. Advance.
            let move = null;
            for (let p of ai) {
                for (let dr = -1; dr <= 1; dr++) {
                    for (let dc = -1; dc <= 1; dc++) {
                        let nr = p.r + dr, nc = p.c + dc;
                        if (nr >= 0 && nr < 9 && nc >= 0 && nc < 9) {
                            let target = pieces[`${nr}-${nc}`];
                            if (target && target.o === 'p1' && winMap[p.t] === target.t) {
                                move = { fr: p.r, fc: p.c, tr: nr, tc: nc };
                            }
                        }
                    }
                }
            }

            if (!move) {
                const p = ai[Math.floor(Math.random() * ai.length)];
                move = { fr: p.r, fc: p.c, tr: Math.max(0, p.r - 1), tc: p.c + (Math.random() > 0.5 ? 1 : -1) };
                if (move.tc < 0 || move.tc > 8) move.tc = p.c;
            }

            processMove(move.fr, move.fc, move.tr, move.tc);
        }

        function updateUI() {
            turnDisplay.textContent = turn === 'p1' ? "Player: Alpha" : "Player: Omega";
            turnDisplay.style.color = turn === 'p1' ? 'var(--p1)' : 'var(--p2)';
        }

        function finish(m) {
            active = false;
            status.textContent = m;
            setTimeout(() => location.reload(), 3000);
        }

        init();
    </script>
</body>
</html>
