<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>9x9 Tactical RPS</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #1a1a1a;
            color: #ddd;
            margin: 0;
            padding: 20px;
        }

        #ui-layer {
            text-align: center;
            margin-bottom: 15px;
        }

        /* 9x9 Grid: 9 columns of 55px */
        #board {
            display: grid;
            grid-template-columns: repeat(9, 55px);
            grid-template-rows: repeat(9, 55px);
            gap: 3px;
            background-color: #444;
            border: 6px solid #111;
            padding: 3px;
        }

        .cell {
            width: 55px;
            height: 55px;
            background-color: #2c3e50;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border-radius: 2px;
        }

        .cell:hover { background-color: #34495e; }

        .piece {
            width: 45px;
            height: 45px;
            border-radius: 8px; /* Slightly squared circles */
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.1rem;
            user-select: none;
            transition: transform 0.1s;
        }

        .p1 { background: #00a8ff; color: #fff; box-shadow: 0 0 10px rgba(0, 168, 255, 0.4); }
        .p2 { background: #ff4757; color: #fff; box-shadow: 0 0 10px rgba(255, 71, 87, 0.4); }

        .selected {
            background-color: #f1c40f !important;
            box-shadow: 0 0 15px #f1c40f;
            transform: scale(1.1);
        }

        #log {
            margin-top: 15px;
            padding: 10px;
            background: #000;
            width: 500px;
            height: 80px;
            overflow-y: auto;
            font-family: monospace;
            border: 1px solid #333;
            color: #0f0;
        }
    </style>
</head>
<body>

    <div id="ui-layer">
        <h2>Tactical RPS (9x9)</h2>
        <h3 id="turn-indicator" style="color: #00a8ff;">Player 1's Turn</h3>
    </div>

    <div id="board"></div>

    <div id="log">Welcome Commander. Eliminate the enemy or cross the line.</div>

    <script>
        const boardElem = document.getElementById('board');
        const turnElem = document.getElementById('turn-indicator');
        const logElem = document.getElementById('log');

        let selected = null;
        let turn = 'p1';
        const matchups = { 'R': 'S', 'S': 'P', 'P': 'R' };

        // 2 of each type per side (6 pieces total per player)
        let pieces = {
            // Player 1 (Top)
            "0-1": { owner: 'p1', type: 'R' }, "0-2": { owner: 'p1', type: 'R' },
            "0-3": { owner: 'p1', type: 'P' }, "0-4": { owner: 'p1', type: 'P' },
            "0-5": { owner: 'p1', type: 'S' }, "0-6": { owner: 'p1', type: 'S' },
            
            // Player 2 (Bottom)
            "8-2": { owner: 'p2', type: 'R' }, "8-3": { owner: 'p2', type: 'R' },
            "8-4": { owner: 'p2', type: 'P' }, "8-5": { owner: 'p2', type: 'P' },
            "8-6": { owner: 'p2', type: 'S' }, "8-7": { owner: 'p2', type: 'S' }
        };

        function draw() {
            boardElem.innerHTML = '';
            for (let r = 0; r < 9; r++) {
                for (let c = 0; c < 9; c++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    const coord = `${r}-${c}`;
                    
                    if (pieces[coord]) {
                        const p = pieces[coord];
                        const pDiv = document.createElement('div');
                        pDiv.className = `piece ${p.owner}`;
                        pDiv.textContent = p.type;
                        if (selected && selected.r === r && selected.c === c) pDiv.classList.add('selected');
                        cell.appendChild(pDiv);
                    }
                    cell.onclick = () => clicked(r, c);
                    boardElem.appendChild(cell);
                }
            }
        }

        function clicked(r, c) {
            const coord = `${r}-${c}`;
            const p = pieces[coord];

            if (p && p.owner === turn) {
                selected = { r, c, p };
                draw();
            } else if (selected) {
                const distR = Math.abs(r - selected.r);
                const distC = Math.abs(c - selected.c);

                if (distR <= 1 && distC <= 1 && (distR + distC > 0)) {
                    move(selected.r, selected.c, r, c);
                }
            }
        }

        function move(fr, fc, tr, tc) {
            const att = pieces[`${fr}-${fc}`];
            const def = pieces[`${tr}-${tc}`];
            const target = `${tr}-${tc}`;

            if (def) {
                if (def.owner === att.owner) return;
                
                if (att.type === def.type) {
                    log(`Clash! Both ${att.type}s hold their ground.`);
                    selected = null; draw(); return;
                } else if (matchups[att.type] === def.type) {
                    log(`P1 ${att.type} destroys P2 ${def.type}!`);
                    pieces[target] = att;
                } else {
                    log(`P1 ${att.type} was countered by P2 ${def.type}!`);
                }
            } else {
                pieces[target] = att;
            }

            delete pieces[`${fr}-${fc}`];
            
            // Win check
            if (att.owner === 'p1' && tr === 8) win("Player 1 reached the end!");
            if (att.owner === 'p2' && tr === 0) win("Player 2 reached the end!");

            turn = turn === 'p1' ? 'p2' : 'p1';
            turnElem.textContent = turn === 'p1' ? "Player 1's Turn" : "Player 2's Turn";
            turnElem.style.color = turn === 'p1' ? "#00a8ff" : "#ff4757";
            selected = null;
            draw();
            checkEmpty();
        }

        function log(m) {
            const d = document.createElement('div');
            d.textContent = "> " + m;
            logElem.prepend(d);
        }

        function checkEmpty() {
            const counts = { p1: 0, p2: 0 };
            Object.values(pieces).forEach(p => counts[p.owner]++);
            if (counts.p1 === 0) win("Player 2 wins by total elimination!");
            if (counts.p2 === 0) win("Player 1 wins by total elimination!");
        }

        function win(m) { alert(m); location.reload(); }

        draw();
    </script>
</body>
</html>
